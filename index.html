<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NOVATREX Exchange</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
body{margin:0;font-family:Poppins;background:#0f1320;color:white;}
.header{display:flex;justify-content:space-between;align-items:center;padding:12px 15px;background:#12162a;}
.logo{width:40px;height:40px;background:linear-gradient(45deg,#00c6ff,#0072ff);border-radius:10px;margin-right:10px;}
.button{padding:8px 18px;border:none;border-radius:8px;background:linear-gradient(45deg,#00c6ff,#00ffcc);color:white;font-weight:600;cursor:pointer;}

.balance{background:#1b1f33;margin:15px;padding:20px;border-radius:15px;position:relative;}
.deposit-btn{position:absolute;top:15px;right:15px;background:linear-gradient(45deg,#00c6ff,#00ffcc);padding:8px 14px;border-radius:10px;cursor:pointer;}

.icon-grid{display:grid;grid-template-columns:repeat(4,1fr);text-align:center;margin-top:60px;}
.icon-grid div{font-size:12px;padding:10px;cursor:pointer;border-radius:8px;background:#171b2e;}
.icon-grid div:hover{background:#00c6ff;color:#000;}

.banner,.market,.history{background:#1b1f33;margin:15px;padding:15px;border-radius:15px;}

.footer{position:fixed;bottom:0;width:100%;background:#12162a;display:flex;justify-content:space-around;padding:10px 0;}

.modal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);display:none;justify-content:center;align-items:center;}
.modal-box{background:#1b1f33;padding:20px;border-radius:12px;width:90%;max-width:320px;}
.modal-box input{width:100%;padding:10px;margin:6px 0;border-radius:8px;border:none;background:#2a2f45;color:white;}
.modal-box button{width:100%;padding:10px;background:linear-gradient(45deg,#00c6ff,#00ffcc);border:none;color:white;border-radius:8px;}
</style>
</head>

<body>

<!-- HEADER -->
<div class="header">
<div style="display:flex;align-items:center">
<div class="logo"></div>
<b>NOVATREX</b>
</div>
<div>
<button class="button" onclick="showAuth()">Connexion</button>
<button class="button" onclick="logout()">Logout</button>
</div>
</div>

<!-- BALANCE -->
<div class="balance">
<h4>Balance USDT</h4>
<h1 id="balance">0.00</h1>
<div class="deposit-btn" onclick="showDeposit()">Deposit</div>

<div class="icon-grid">
<div onclick="showWithdraw()">Withdraw</div>
<div onclick="invite()">Invite</div>
<div onclick="cert()">Certification</div>
<div onclick="adminDeposit()">Admin Credit</div>
</div>
</div>

<div class="banner">
<h3>Crypto Dashboard NOVATREX</h3>
<div id="tradingview_chart"></div>
</div>

<div class="market">
<h3>Market</h3>
<p>Novacoin : <span id="novacoinPrice">1.00</span></p>
<p>BTC : <span id="btc">...</span></p>
<p>ETH : <span id="eth">...</span></p>
</div>

<div class="history" id="history">
<h4>History</h4>
</div>

<div class="footer">
<div>Home</div>
<div>Market</div>
<div>Trade</div>
<div>Wallet</div>
</div>

<!-- AUTH MODAL -->
<div class="modal" id="authModal">
<div class="modal-box">
<h3>Login / Create</h3>
<input id="email" placeholder="Email">
<input id="pass" type="password" placeholder="Password">
<button onclick="auth()">Submit</button>
</div>
</div>

<!-- DEPOSIT -->
<div class="modal" id="depositModal">
<div class="modal-box">
<h3>Deposit</h3>
<input id="depositAmount" placeholder="Amount">
<button onclick="deposit()">Confirm</button>
</div>
</div>

<!-- WITHDRAW -->
<div class="modal" id="withdrawModal">
<div class="modal-box">
<h3>Withdraw</h3>
<input id="withdrawAmount" placeholder="Amount">
<button onclick="withdraw()">Confirm</button>
</div>
</div>

<script src="https://s3.tradingview.com/tv.js"></script>

<script>
new TradingView.widget({
width:"100%",
height:250,
symbol:"BINANCE:BTCUSDT",
interval:"5",
container_id:"tradingview_chart"
});

let users = JSON.parse(localStorage.getItem("users")||"{}");
let currentUser = localStorage.getItem("currentUser");

if(!users.admin){
users.admin={password:"admin",balance:100000,admin:true,history:[]};
}

function save(){
localStorage.setItem("users",JSON.stringify(users));
localStorage.setItem("currentUser",currentUser);
}

function updateBalance(){
if(!currentUser)return;
balance.innerText = users[currentUser].balance.toFixed(2);
renderHistory();
}

function renderHistory(){
let box=document.getElementById("history");
box.innerHTML="<h4>History</h4>";
(users[currentUser].history||[]).slice().reverse().forEach(e=>{
let div=document.createElement("div");
div.innerText=e.date+" - "+e.type+" "+e.amount;
box.appendChild(div);
});
}

function addHistory(type,amount){
users[currentUser].history.push({
type,
amount,
date:new Date().toLocaleString()
});
save();
renderHistory();
}

function showAuth(){authModal.style.display="flex";}
function showDeposit(){if(!currentUser)return alert("Login"); depositModal.style.display="flex";}
function showWithdraw(){if(!currentUser)return alert("Login"); withdrawModal.style.display="flex";}

window.onclick = e=>{
if(e.target.classList.contains("modal")) e.target.style.display="none";
}

function auth(){
let e=email.value;
let p=pass.value;

if(users[e]){
if(users[e].password!==p) return alert("Wrong pass");
}else{
users[e]={password:p,balance:0,history:[]};
}

currentUser=e;
save();
authModal.style.display="none";
updateBalance();
}

function logout(){
currentUser=null;
localStorage.removeItem("currentUser");
balance.innerText="0.00";
}

function deposit(){
let a=parseFloat(depositAmount.value);
if(!users[currentUser].admin) return alert("Admin only");
users[currentUser].balance+=a;
addHistory("Deposit",a);
depositModal.style.display="none";
updateBalance();
}

function adminDeposit(){
if(!users[currentUser].admin) return alert("Admin only");
let u=prompt("User email ?");
let a=parseFloat(prompt("Amount ?"));
if(users[u]){
users[u].balance+=a;
save();
alert("Credited");
}
}

function withdraw(){
let a=parseFloat(withdrawAmount.value);
if(a>users[currentUser].balance) return alert("Insufficient");
users[currentUser].balance-=a;
addHistory("Withdraw",a);
withdrawModal.style.display="none";
updateBalance();
}

function invite(){
alert("Referral : novatrex/ref/"+currentUser);
}

function cert(){ alert("Verification completed"); }

/* MARKET SIMULATION */
let novacoin=1;
setInterval(()=>{
novacoin += Math.random()*0.02;
novacoinPrice.innerText = novacoin.toFixed(2);
btc.innerText = (80000+Math.random()*2000).toFixed(2);
eth.innerText = (4000+Math.random()*400).toFixed(2);
},4000);

if(currentUser) updateBalance();
</script>
</body>
</html>
